from pwn import *



"""
binary search challenge
"""


def return_list(min, max):
	s = ''
	for i in range(min, max):
		s += str(i) + ' '
	return s


def main():

	#r = remote('pwnable.kr', 9007)
	r = remote('0', 9007)

	print r.recv()
	print("_______________________________________________________________________________")

	number = r.recv()

	for i in range(101):
		if i == 100:
			print "The flag is:	" + r.recv()
			exit(0)
		print "round %d" % i
		max = int(number[number.find('N=') + 2: number.find(' ')])
		C = int(number[number.find('C=') + 2:])
		min = 0
		#print "N=" + str(max)
		#print "C=" + str(C)


		while C:
			C -= 1
			#print "max = %d, min = %d" % (max, min)
			#print return_list(min, min + ((max - min) / 2))
			r.sendline(return_list(min, min + ((max - min) / 2)))
			result = r.recvline()
			#print "result = " + str(result)

			if int(result) % 10 == 0:
				min = min + ((max - min) / 2)
			else:
				max = min + ((max - min) / 2)


			if max - min <= 1:
				#print "max = %d, min = %d" % (max, min)
				r.sendline(str(min))
				result = r.recvline()
				if 'Correct!' in result:
					pass
				else:
					r.sendline(str(min))
					result = r.recvline()
				print result
				number = r.recvline()

				break
			if C == 0:
				print "There is no more C..."
				x = input




main()